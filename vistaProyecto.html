<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vista de Proyecto - PDT Futura</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="vistaProyecto.css">
</head>
<body>
    <div class="container" id="project-container">
        <!-- Logo de la compa√±√≠a al inicio -->
        <div class="company-logo-top">
            <img src="logo_2025web.png" alt="Logo G&N CE" width="200">
        </div>

        <div class="header">
            <h1 id="project-name">Cargando proyecto...</h1>
            <p>Cronograma de Proyecto - L√≠nea de Tiempo Interactiva</p>
            <div class="progress-summary">
                <div class="progress-text">Progreso General del Proyecto</div>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="overall-progress"><span id="progress-text">0%</span></div>
                </div>
                <div class="progress-stats">
                    <div class="stat-item">
                        <span class="stat-number" id="total-tasks">0</span>
                        <span>Total de Tareas</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="total-hours">0</span>
                        <span>Total de Horas</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="completed-tasks">0</span>
                        <span>Tareas Completadas</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="completed-hours">0</span>
                        <span>Horas Completadas</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="timeline-container">
            <div class="project-dates-interactive" id="informacionProyecto">
                <h3>Datos generales del Proyecto</h3>
                <div class="project-config">
                    <!-- Configuraci√≥n de Fechas -->
                    <div class="config-group">
                        <h4 class="config-group-title">üìÖ Configuraci√≥n de Fechas</h4>
                        <div class="config-row">
                            <div class="config-item">
                                <label for="start-date-input">Fecha de Inicio:</label>
                                <input type="date" id="start-date-input">
                            </div>
                        </div>
                    </div>

                    <!-- Configuraci√≥n de D√≠as Laborables -->
                    <div class="config-group">
                        <h4 class="config-group-title">üìÜ D√≠as Laborables</h4>
                        <div class="config-row">
                            <div class="config-item">
                                <label for="include-saturdays">Excluir S√°bados:</label>
                                <input type="checkbox" id="include-saturdays">
                            </div>
                            <div class="config-item">
                                <label for="include-sundays">Excluir Domingos:</label>
                                <input type="checkbox" id="include-sundays">
                            </div>
                            <div class="config-item">
                                <label for="include-holidays">Excluir Festivos del calendario laboral:</label>
                                <input type="checkbox" id="include-holidays">
                            </div>
                        </div>
                        <div class="holidays-list" id="holidays-list" style="display: none;">
                            <h4>Festivos Seleccionados:</h4>
                            <div id="holidays-container"></div>
                            <button type="button" id="add-holiday-btn">Agregar Festivo</button>
                        </div>
                    </div>

                    <!-- Configuraci√≥n de Horarios -->
                    <div class="config-group">
                        <h4 class="config-group-title">‚è∞ Horarios de Trabajo</h4>
                        <div class="config-row">
                            <div class="config-item">
                                <label for="shift-start-time">Hora Inicio Turno:</label>
                                <input type="time" id="shift-start-time" value="08:00">
                            </div>
                            <div class="config-item">
                                <label for="shift-end-time">Hora Fin Turno:</label>
                                <input type="time" id="shift-end-time" value="17:00">
                            </div>
                        </div>
                        <div class="config-row">
                            <div class="config-item">
                                <label for="shift-break-start-time">Inicio Descanso:</label>
                                <input type="time" id="shift-break-start-time" value="12:00">
                            </div>
                            <div class="config-item">
                                <label for="shift-break-hours">Horas Descanso Turno:</label>
                                <input type="number" id="shift-break-hours" min="0" max="8" step="0.5" value="1">
                            </div>
                        </div>
                    </div>

                    <!-- Botones de Acci√≥n -->
                    <div class="config-group">
                        <div class="config-buttons">
                            <button id="recalculate-dates-btn">Aplicar Cambios</button>
                        </div>
                    </div>
                </div>
                <div class="date-info">
                    <p><strong>Inicio:</strong> <span id="project-start-date">--</span></p>
                    <p><strong>Fin Estimado:</strong> <span id="project-end-date">--</span></p>
                    <p><strong>Duraci√≥n:</strong> <span id="project-duration">--</span> d√≠as</p>
                    <p><strong>√öltima Actualizaci√≥n:</strong> <span id="project-last-update">--</span></p>
                </div>
            </div>
            <div id="phases-container" class="phases-container">
                <!-- Las fases y tareas se cargar√°n aqu√≠ -->
            </div>
            
            <!-- Leyenda de tareas -->
            <div class="tasks-legend">
                <h3>Leyenda de Tareas</h3>
                <div class="legend-items">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #f8f9fa; border-left: 4px solid #bdc3c7;"></div>
                        <span>Tarea Regular</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color milestone" style="background: linear-gradient(135deg, #fff5f5, #ffeaea); border-left: 4px solid #e74c3c;"></div>
                        <span>Hito üéØ</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color completed" style="background: #d4edda; border-left: 4px solid #28a745;"></div>
                        <span>Tarea Completada ‚úÖ</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-symbol">
                            <span class="task-hours-example">8h</span>
                        </div>
                        <span>Horas de la tarea</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-symbol">
                            <span class="task-dates-example">01/01 - 05/01</span>
                        </div>
                        <span>Fechas de inicio y fin</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-symbol">
                            <span style="font-size: 0.7rem; color: #2c3e50;">08:00 - 17:00</span>
                        </div>
                        <span>Horas espec√≠ficas de tareas</span>
                    </div>
                </div>
            </div>
            
            <div class="calendar-section" id="calendarioProyecto">
                <h2>Calendario del Proyecto</h2>
                <div id="calendar-container"></div>
            </div>

            <!-- Modal de tareas del d√≠a -->
            <div id="day-tasks-modal" class="modal-overlay">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="modal-date-title">Tareas del d√≠a</h3>
                        <button id="close-modal-btn" class="close-modal-btn">&times;</button>
                    </div>
                    <div id="modal-tasks-list" class="modal-tasks-list">
                        <!-- Las tareas se cargar√°n aqu√≠ din√°micamente -->
                    </div>
                </div>
            </div>

            <div class="s-curve-section" id="curvaSProyecto">
                <h2>Curva S - Seguimiento del Proyecto</h2>
                <div id="s-curve-chart" style="width: 100%; height: 500px;"></div>
                <div class="s-curve-metrics">
                    <div class="metric-card">
                        <div class="metric-value" id="schedule-variance">--</div>
                        <div class="metric-label">Variaci√≥n de Cronograma</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="performance-index">--</div>
                        <div class="metric-label">√çndice de Rendimiento</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="project-status">--</div>
                        <div class="metric-label">Estado del Proyecto</div>
                    </div>
                </div>
            </div>

            <div class="gantt-section" id="ganttProyecto">
                <h2>Diagrama de Gantt - Cronograma de Tareas</h2>
                <div id="gantt-chart-container"></div>
            </div>

            <div style="text-align: center; margin: 20px 0;" id="project-actions">
                <button id="back-to-projects-btn">Volver a Proyectos</button>
                <button id="logout-btn">Cerrar Sesi√≥n</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <!-- Chart.js para gr√°ficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Configuraci√≥n centralizada de Firebase -->
    <script src="config/firebase.js"></script>

    <!-- Servicio de notificaciones -->
    <script src="notification-service.js"></script>

    <!-- Bot√≥n flotante de navegaci√≥n -->
    <div id="floatingNavBtn">
        <img src="IconoGNCE.png" alt="Men√∫ de navegaci√≥n" style="width: 24px; height: 24px;">
        <div id="floatingNavMenu">
            <a href="#informacionProyecto">Informaci√≥n</a>
            <a href="#phases-container">Fases</a>
            <a href="#calendarioProyecto">Calendario</a>
            <a href="#curvaSProyecto">Curva S</a>
            <a href="#ganttProyecto">Gantt</a>
            <a href="#project-actions">Finalizar</a>
        </div>
    </div>

    <script src="vistaProyecto.js"></script>
</body>
</html>
